"var E=Object.defineProperty;var h=(t,e,n)=>e in t?E(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var y=(t,e,n)=>(h(t,typeof e!=\"symbol\"?e+\"\":e,n),n);var A=(t,e)=>({value:t,transferables:e,__x_tdata__:1432234}),w=t=>typeof t==\"object\"&&t!==null&&\"__x_tdata__\"in t&&t?.__x_tdata__===1432234;var u=\"__x_rpc_error__\",f=\"__x_rpc_response__\",p=[],i=class{idCount;queue;actionsIndex;messageContainer;messageTarget;messageInterceptor;constructor({responses:e,messageTarget:n,messageInterceptor:r}){this.messageInterceptor=r,this.messageTarget=n,this.messageInterceptor.addEventListener(\"message\",a=>{s.consumeMessage(a.data,\"source\"in a&&a.source||null)});let s=this;this.idCount=0,this.queue=[],this.messageContainer={handle:\"\",id:-1,respondingTo:-1,data:null},this.actionsIndex=new Map;let o=Object.keys(e);for(let a=0;a<o.length;a++){let l=o[a];this.actionsIndex.set(l,e[l])}}async executeWithSource(e,n,r,s){return await this.outboundMessage(n,e,r,s)}async execute(e,n=null,r=p){return await this.outboundMessage(this.messageTarget,e,n,r)}outboundMessage(e,n,r=null,s=p){let o=this;return new Promise((a,l)=>{let m=this.idCount;o.queue.push({id:m,resolve:a,reject:l}),o.transferMessage(e,n,-1,r,s)})}responseMessage(e,n,r){let s=w(r);this.transferMessage(e,f,n,s?r.value:r,s?r.transferables:p)}errorResponseMessage(e,n,r){this.transferMessage(e,u,n,r)}transferMessage(e,n,r,s,o){let{messageContainer:a}=this,l=this.idCount++;return a.handle=n,a.respondingTo=r,a.data=s??null,a.id=l,(e||this.messageTarget).postMessage(a,o||p),a.data=null,l}async consumeMessage(e,n){if(e===null||typeof e!=\"object\"){console.warn(\"recieved message was not an object ignoring message\",e);return}if(e.handle===f||e.handle===u){let{queue:r}=this;for(let s=0;s<r.length;s++){let o=r[s];if(e.respondingTo===o.id){e.handle===u?o.reject(e.data):o.resolve(e.data),r.splice(s,1);return}}console.warn(\"incoming response doesn't map to any queued message. ignoring\",e);return}if(!this.actionsIndex.has(e.handle)){this.errorResponseMessage(n,e.id,`attempted to call non-existent handler \"${e.handle}\"`);return}if(e.respondingTo===-1){let r=this.actionsIndex.get(e.handle);try{let s=await r(e.data)??null;this.responseMessage(n,e.id,s)}catch(s){this.errorResponseMessage(n,e.id,`rpc function \"${e.handle}\" encountered an exception. ${s} ${s?.stack||\"no-stack\"}`)}return}console.warn(\"incoming message is neither a response to a previous message or a request to perform an action. ignoring message\",e)}};y(i,\"transfer\",A);var R=self,{parent:v}=R,c=new i({responses:{},messageTarget:{postMessage:(t,e)=>{v.postMessage(t,\"*\",e)}},messageInterceptor:{addEventListener:(t,e)=>{R.addEventListener(\"message\",e)}}}),x={getFile:async t=>{let e=await c.execute(\"getFile\",t);return e&&i.transfer(e,[e.body])}};var b=\"mirror-sw.compiled.js\";if(window.top!==window.parent)throw new Error(\"second-level embedding is disallowed\");if(window.self===window.top)throw new Error(\"document must be embedded in iframe\");if(!(\"serviceWorker\"in navigator))throw await c.execute(\"signalFatalError\",\"\"),new Error(\"sandbox requires service worker to function\");var[M]=await Promise.all([navigator.serviceWorker.ready,navigator.serviceWorker.register(b)]),{active:_}=M,V=new i({responses:x,messageTarget:{postMessage(t,e){_?.postMessage(t,e)}},messageInterceptor:{addEventListener(t,e){navigator.serviceWorker.addEventListener(\"message\",n=>{console.log(\"message source\",n.source),e(n)})}}}),g=await c.execute(\"getInitialState\");if(!g)throw await c.execute(\"signalFatalError\",\"\"),new Error(\"passed initial state was invalid\");var T=document.createElement(\"div\");T.setAttribute(\"id\",\"root\");document.body.appendChild(T);var k={rootElement:T,messageAppShell:(t,e=null,n=I)=>c.execute(t,e,n),initialState:g};await c.execute(\"secureContextEstablished\");var S=document.getElementById(\"root-script\"),d=await(async t=>{try{return console.info(\"importing\",t),await import(t)}catch(e){return console.error(\"encouintered error when importing module\",e),null}})(S?.getAttribute(\"entry\")||\"none\");if(!d||!(\"main\"in d))throw c.execute(\"signalFatalError\",g.authToken),new Error(\"no main function exported from module\");var{main:P}=d,I=[];P(k);\n"