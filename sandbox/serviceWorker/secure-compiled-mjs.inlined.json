"var E=Object.defineProperty;var h=(n,e,t)=>e in n?E(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var m=(n,e,t)=>(h(n,typeof e!=\"symbol\"?e+\"\":e,t),t);var A=(n,e)=>({value:n,transferables:e,__x_tdata__:1432234}),w=n=>typeof n==\"object\"&&n!==null&&\"__x_tdata__\"in n&&n?.__x_tdata__===1432234;var u=\"__x_rpc_error__\",f=\"__x_rpc_response__\",l=[],i=class{idCount;queue;actionsIndex;messageContainer;messageTarget;messageInterceptor;constructor({responses:e,messageTarget:t,messageInterceptor:r}){this.messageInterceptor=r,this.messageTarget=t,this.messageInterceptor.addEventListener(\"message\",a=>{s.consumeMessage(a.data,\"source\"in a&&a.source||null)});let s=this;this.idCount=0,this.queue=[],this.messageContainer={handle:\"\",id:-1,respondingTo:-1,data:null},this.actionsIndex=new Map;let o=Object.keys(e);for(let a=0;a<o.length;a++){let p=o[a];this.actionsIndex.set(p,e[p])}}async executeWithSource(e,t,r,s){return await this.outboundMessage(t,e,r,s)}async execute(e,t=null,r=l){return await this.outboundMessage(this.messageTarget,e,t,r)}outboundMessage(e,t,r=null,s=l){let o=this;return new Promise((a,p)=>{let y=this.idCount;o.queue.push({id:y,resolve:a,reject:p}),o.transferMessage(e,t,-1,r,s)})}responseMessage(e,t,r){let s=w(r);this.transferMessage(e,f,t,s?r.value:r,s?r.transferables:l)}errorResponseMessage(e,t,r){this.transferMessage(e,u,t,r)}transferMessage(e,t,r,s,o){let{messageContainer:a}=this,p=this.idCount++;return a.handle=t,a.respondingTo=r,a.data=s??null,a.id=p,(e||this.messageTarget).postMessage(a,o||l),p}async consumeMessage(e,t){if(e===null||typeof e!=\"object\"){console.warn(\"recieved message was not an object ignoring message\",e);return}if(e.handle===f||e.handle===u){let{queue:r}=this;for(let s=0;s<r.length;s++){let o=r[s];if(e.respondingTo===o.id){e.handle===u?o.reject(e.data):o.resolve(e.data),r.splice(s,1);return}}console.warn(\"incoming response doesn't map to any queued message. ignoring\",e);return}if(!this.actionsIndex.has(e.handle)){this.errorResponseMessage(t,e.id,`attempted to call non-existent handler \"${e.handle}\"`);return}if(e.respondingTo===-1){let r=this.actionsIndex.get(e.handle);try{let s=await r(e.data)??null;this.responseMessage(t,e.id,s)}catch(s){this.errorResponseMessage(t,e.id,`rpc function \"${e.handle}\" encountered an exception. ${s} ${s?.stack||\"no-stack\"}`)}return}console.warn(\"incoming message is neither a response to a previous message or a request to perform an action. ignoring message\",e)}};m(i,\"transfer\",A);var R=self,{parent:v}=R,c=new i({responses:{},messageTarget:{postMessage:(n,e)=>{v.postMessage(n,\"*\",e)}},messageInterceptor:{addEventListener:(n,e)=>{R.addEventListener(\"message\",e)}}}),x={getFile:async n=>{let e=await c.execute(\"getFile\",n);return e&&i.transfer(e,[e.body])}};var b=\"mirror-sw.compiled.js\";if(window.top!==window.parent)throw new Error(\"second-level embedding is disallowed\");if(window.self===window.top)throw new Error(\"document must be embedded in iframe\");if(!(\"serviceWorker\"in navigator))throw await c.execute(\"signalFatalError\",\"\"),new Error(\"sandbox requires service worker to function\");var[M]=await Promise.all([navigator.serviceWorker.ready,navigator.serviceWorker.register(b)]),{active:_}=M,V=new i({responses:x,messageTarget:{postMessage(n,e){_?.postMessage(n,e)}},messageInterceptor:{addEventListener(n,e){navigator.serviceWorker.addEventListener(\"message\",e)}}}),g=await c.execute(\"getInitialState\");if(!g)throw await c.execute(\"signalFatalError\",\"\"),new Error(\"passed initial state was invalid\");var T=document.createElement(\"div\");T.setAttribute(\"id\",\"root\");document.body.appendChild(T);var k={rootElement:T,messageAppShell:(n,e=null,t=I)=>c.execute(n,e,t),initialState:g};await c.execute(\"secureContextEstablished\");var S=document.getElementById(\"root-script\"),d=await(async n=>{try{return console.info(\"importing\",n),await import(n)}catch(e){return console.error(\"encouintered error when importing module\",e),null}})(S?.getAttribute(\"entry\")||\"none\");if(!d||!(\"main\"in d))throw c.execute(\"signalFatalError\",g.authToken),new Error(\"no main function exported from module\");var{main:P}=d,I=[];P(k);\n"